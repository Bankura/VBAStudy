VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "SheetData"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Option Explicit


Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo ErrorHandler
    If dsKoubanCol = 0 Then
        Call Init
    End If
    If Me.Cells(Target.row, dsKoubanCol).Value = "" Then
        Call MyUnprotectSheet
        Me.Cells(Target.row, dsKoubanCol).Value = Target.row - dsStartRow + 1
        Call MyProtectSheet
    End If
    Exit Sub
ErrorHandler:
    Call ErrorProcess
End Sub

Private Sub MyUnprotectSheet()
    'シート保護解除
    If TOOL_PASSWORD = "" Then
        Me.Unprotect
    Else
        Me.Unprotect Password:=TOOL_PASSWORD
    End If
End Sub

Private Sub MyProtectSheet()
    'シート保護
    If TOOL_PASSWORD = "" Then
        Me.Protect
    Else
        Me.Protect Password:=TOOL_PASSWORD
    End If
End Sub
